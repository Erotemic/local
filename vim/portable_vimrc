"============ TOP LEVEL COMMANDS ================"
" Some of these probably need to be cleaned up
syntax on
filetype plugin indent on
" MISC: win clipboard on linux
if has("win32") || has("win16")
else
    source $VIMRUNTIME/mswin.vim
endif

" Turn backup off, since most stuff is in SVN, git et.c anyway...
set ff=unix
set ffs=unix,dos
if has("win32") || has("win16")
    set backupdir=D:/sys/vim_tmp/
    set undodir=D:/sys/vim_tmp/
else
    set backupdir=/media/Store/sys/vim_tmp/
    set undodir=/media/Store/sys/vim_tmp/
endif
set nobackup
set autochdir

set nomousehide
set nowb
set noswapfile
" Do not open these sort of files
set wildignore=*.o,*~,*.pyc,*.aux,*.masv,*.bbl,*.bcf,*.blg,*.brf,*.synctex,*.upa,*.upb,*.pdf,*.dvi

set wildmode=longest,list,full
set wildmenu

" =========== MISC  ==========="
imap bufloadpy :args *.py
"-------------------------
" MISC: win clipboard on linux
if has("win32") || has("win16")
else
    set clipboard=unnamedplus
endif
"-------------------------
command! HexmodeOn :%!xxd
command! HexmodeOff :%!xxd -r 
"-------------------------

set shellslash
set grepprg=grep\ -nH\ $*

" PLUGINS
source ~/local/vim/plugin_prefs.vim

" Unsorted Preferences

" ========= VIM PREFERENCES ========= "
if has("gui_running")
    "colorscheme murphy
    colorscheme synic
endif
set shiftwidth=4
set tabstop=4
set expandtab
set cino={1s
set autoread
set lbr " Linebreak on 500 characters
set tw=500

" Vim: Gray Line Numbering
:set nu 
if has("gui_running")
    :highlight LineNr guifg=#333333
    " Cross platform fonts
    if has("win32") || has("win16")
        :highlight LineNr font='Fixedsys'
    else
        :highlight LineNr font='Monospace'
    endif
endif

"-------------------------

"Windows symlink problems
set bkc=yes
set nobackup 
set nowritebackup

"-------------------------
"Filebar
:set go+=r go+=R go-=l go-=L

"-------------------------
"Windows start command
command! S :call OpenWindow()
command! CMD :ConqueTerm cmd 
command! CMD2 :ConqueTermTab cmd 
command! -nargs=1 R :vertical resize <f-args>

"-------------------------
" Function Remaps
"map <F1> :call  ToggleWordHighlight()<CR> 
"Map Ctrl+W (navkey) to Ctrl+(navkey) (for split windows)
" Remap the leader key from \ to ,
let mapleader = ","
nnoremap <Leader>e :lopen <CR>
nnoremap <Leader>w w :<c-w> <c-w>
nnoremap <Leader>d :FontDecrease<c-w> <c-w>
map <c-j> <c-w>j
map <c-k> <c-w>k
map <c-l> <c-w>l
map <c-h> <c-w>h
map <F1> :call  PEP8PRINT()<CR> 
map <F2> :call  ToggleAlpha()<CR> 
map <F3> :call  ToggleFont()<CR> 
map <F4> :call  OpenWindow()<CR> 
map <F5> :call  CmdHere()<CR> 
"vim-latex-suit overwrites f5, give it an alt
map <F6> :call  CmdHere()<CR>  
" make semicolon command mode
nmap ; :
" Compile Command Remaps
nnoremap <Leader>p :call Tex_RunViewLaTeX()<CR>
nmap <C-P> :call Tex_RunViewLaTeX() <CR>
imap <C-P> :call Tex_RunViewLaTeX() <CR>
map <F8> :call  Tex_RunViewLaTeX()<CR>  

"-------------------------
"Make txx file work as cpp files


"au! BufNewFile,BufRead *.py, *.pyx setlocal foldmethod=indent
"au! BufNewFile,BufRead *.py, *.pyx setlocal nosmartindent
"au! BufNewFile,BufRead *.c, *.cxx, *.cpp, *.h, *.hpp, *.hxx setlocal cino=i-s
"au! BufNewFile,BufRead *.c, *.cxx, *.cpp, *.h, *.hpp, *.hxx setlocal cinkeys-=0#
"au! BufNewFile,BufRead *.c, *.cxx, *.cpp, *.h, *.hpp, *.hxx setlocal foldmethod=syntax


func! MYINFO()
    :ECHOVAR cino
    :ECHOVAR cinkeys
    :ECHOVAR foldmethod
    :ECHOVAR filetype
    :ECHOVAR smartindent
endfu
command! MYINFOCMD call MYINFO() <C-R>

":call AUTOCMD_CPP('set cino=i-s')
":call AUTOCMD_CPP('set cinkeys=0{,0},0),:,!^F,o,O,e')
":call AUTOCMD_CPP('set cinkeys-=0#')

"-------------------------
"":au! CursorMoved * exe printf('match DiffChange /\V\<%s\>/', escape(expand('<cword>'), '/\'))

" Set the default font to mono dyslexic size 11
:call SetFontMonoDyslexic()

" why wont this work
highlight Cursor guifg=blue guibg=orange

"Autocomplete off
let g:Tex_SmartKeyDot=0

au FileType python set omnifunc=pythoncomplete#Complete
au FileType python set nosmartindent
au FileType python filetype indent on
au FileType python set textwidth=80
au FileType python set foldmethod=indent

au BufNewFile,BufRead *.tex call LatexInitialize() 
au SwapExists * let v:swapchoice = 'e'

au BufNewFile,BufRead *.txx  set ft=cpp
au BufNewFile,BufRead *.poly set ft=cmake
au BufNewFile,BufRead *.spec set ft=python
au BufNewFile,BufRead *.node set ft=cmake
au BufNewFile,BufRead *.ele  set ft=cmake
au BufNewFile,BufRead *.ahk, set ft=Autohotkey
"Read vidtk config files as vidtk config file
au BufRead,BufNewFile *.conf setfiletype vidtkconf
" Remove trailing whitespace
au BufWritePre *.py :%s/\s\+$//e
au BufWritePre *.c :%s/\s\+$//e
au BufWritePre *.cxx :%s/\s\+$//e
au BufWritePre *.cpp :%s/\s\+$//e
au BufWritePre *.h :%s/\s\+$//e
au BufWritePre *.hpp :%s/\s\+$//e
au BufWritePre *.hxx :%s/\s\+$//e

" Default
"set foldmethod=indent

" Python indenting and folding

" C++ indenting and folding
au FileType cpp set cino=i-s
au FileType cpp set cinkeys=0{,0},0),:,!^F,o,O,e
au FileType cpp set cinkeys-=0#
au FileType cpp set smartindent
au FileType cpp set foldmethod=syntax

au CursorMoved * call WordHighlightFun()
au InsertLeave * hi Cursor guibg=red
au InsertEnter * hi Cursor guibg=green

hi StatusLine ctermbg=red ctermfg=green
hi StatusLine guibg=gray10 guifg=green

" Need to comment "set diffexpr=MyDiff() in windows to get msys-diffutils to work

" code folding 
"set nofoldenable
"set ai "Auto indent
"set si "Smart indent
"set foldnestmax=1
"set foldlevel=1
"let g:SimpylFold_docstring_preview = 1

"Map space to toggle current fold
noremap <space> za
"Map Shift+Space to close all folds
noremap <S-Space> zM
"Map Ctrl+Space to open all folds
noremap <C-Space> zR

noremap <Leader>r zR<CR>
noremap <Leader>j :NERDTreeToggle<CR>
noremap <Leader>f :NERDTreeFromBookmark 
"noremap <Leader>r zR<CR>

set hlsearch
" :s/\( *\):/:\1/gc
